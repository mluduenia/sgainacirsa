<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:sec="http://www.springframework.org/security/tags"
	xmlns:f="http://java.sun.com/jsf/core" xmlns:p="http://primefaces.org/ui">
<h:body>

	<ui:composition template="template/template.xhtml">
		<ui:define name="content">

			<p:ajaxStatus style="width:16px;height:16px;" id="ajaxStatusPanel">
				<f:facet name="start">
					<h:graphicImage value="/images/ajaxloadingbar.gif" />
				</f:facet>

				<f:facet name="complete">
					<h:outputText value="" />
				</f:facet>
			</p:ajaxStatus>

			<h:form id="formCharts">
				<p:messages id="messages" showDetail="true" redisplay="true" closable="true" />

				<p:fieldset legend="#{messages.limnigrama_intervalo_dias}">
					<p:panelGrid id="panelFiltro" style="width:100%">

						<p:row>

							<p:column style="vertical-align:top;">
								<h:outputLabel value="#{messages.fecha_desde}:" />
								<p:calendar id="fechaDesde" value="#{limnigramaIntervaloMB.filterdw.tTimeDesde}" mode="inline" pattern="dd/MM/yyyy" locale="#{loginMBean.locale}">
								</p:calendar>


							</p:column>

							<p:column style="vertical-align:top;">
								<h:outputLabel value="#{messages.fecha_hasta}:" />
								<p:calendar id="fechaHasta" value="#{limnigramaIntervaloMB.filterdw.tTimeHasta}" mode="inline" pattern="dd/MM/yyyy" locale="#{loginMBean.locale}">
								</p:calendar>
							</p:column>


							<p:column style="vertical-align:top;">
								<h:outputLabel value="#{messages.sensor}:" />
								<p:selectManyCheckbox id="grid3" value="#{limnigramaIntervaloMB.selectedEstaciones}" layout="grid" columns="2">
									<f:selectItems value="#{limnigramaIntervaloMB.siEstaciones}" var="car" itemLabel="#{car}" itemValue="#{car}" />
								</p:selectManyCheckbox>
								<p:commandButton id="cmdSearch" ajax="true" value="#{messages.actualizar}" title="#{messages.actualizar_limnigrama}" actionListener="#{limnigramaIntervaloMB.search}" icon="ui-icon-search"
									update="chartNivel,messages" />
								<p:commandButton ajax="true" value="#{messages.selecc_todos}" title="#{messages.seleccionar_todos_sensores}" actionListener="#{limnigramaIntervaloMB.selectAll}" icon="ui-icon-circle-check"
									update="grid3,messages" />
								<p:commandButton ajax="true" value="#{messages.deselecc_todos}" title="#{messages.deseleccionar_todos_sensores}" actionListener="#{limnigramaIntervaloMB.unselectAll}"
									icon="ui-icon-circle-minus" update="grid3,messages" />
							</p:column>

						</p:row>
						<p:row>
							<p:column style="vertical-align:top;">
								<p:selectBooleanCheckbox styleClass="booleanCheckbox" itemLabel="#{messages.mostrar_puntos}" value="#{limnigramaIntervaloMB.mostrarPuntos}" />
							</p:column>
						</p:row>
					</p:panelGrid>


					<p:chart id="chartNivel" widgetVar="wv_chart_nivel" type="line" model="#{limnigramaIntervaloMB.dateModel}" style="height:400px;">

					</p:chart>
					<p:commandButton type="button" value="#{messages.exportar_grafico}" icon="ui-icon-extlink" onclick="exportChart()" />
				</p:fieldset>
			</h:form>

			<p:dialog widgetVar="dlg" showEffect="fade" width="100%" height="500px" modal="true" header="#{messages.imagen_grafico}" responsive="true" resizable="true" position="left top">
				<p:outputPanel id="output" layout="block" />
			</p:dialog>

			<script type="text/javascript">
				function exportChart() {				
					$('#output').empty().append(PF('wv_chart_nivel').exportAsImage());					
					PF('dlg').show();
				}
			</script>



		</ui:define>
	</ui:composition>

</h:body>

</html>

